Object subclass: #FileSystemOO	instanceVariableNames: 'root'	classVariableNames: ''	poolDictionaries: ''	category: 'Objetos 2-TP 2 - Ej 04'!!FileSystemOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/29/2015 22:33'!listOfContent: aDirectory	"Lista el contenido del directorio y sus directorios, hasta llegar a al último directorio."	aDirectory showList! !!FileSystemOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/28/2015 19:19'!moreRecentlyArchive: aDirectory	"Busca el archivo más recientemente creado a partir del directorio recibido como parámetro."	^ aDirectory moreRecentlyArchive! !!FileSystemOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/28/2015 19:22'!occupiedTotalSize: aDirectory	"Retorna el tamaño total ocupado por el contenido del directorio que se recibe como argumento."	^ aDirectory contentSize! !!FileSystemOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/28/2015 19:18'!biggerArchive: aDirectory	"Retorna el archivo más grande dentro del directorio recibido, se busca recursivamente hasta llegar a una de las hojas."		^ aDirectory biggerArchive ! !!FileSystemOO methodsFor: 'accessing' stamp: 'CristianBarbaro 4/23/2015 15:08'!root: aFile	root := aFile! !!FileSystemOO methodsFor: 'accessing' stamp: 'CristianBarbaro 4/23/2015 15:07'!root	^ root! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!FileSystemOO class	instanceVariableNames: ''!!FileSystemOO class methodsFor: 'constructor' stamp: 'CristianBarbaro 4/28/2015 19:12'!newWithRoot: aRoot	^ self new root: aRoot! !TestCase subclass: #FileSystemOOTest	instanceVariableNames: 'root dir1 dir2 dir3 arch1 arch2 arch3 arch4 fs'	classVariableNames: ''	poolDictionaries: ''	category: 'Objetos 2-TP 2 - Ej 04'!!FileSystemOOTest methodsFor: 'testing' stamp: 'CristianBarbaro 4/29/2015 23:51'!testBiggerArchive	self should:  [(fs biggerArchive: root) size = arch3 size ].! !!FileSystemOOTest methodsFor: 'initialize' stamp: 'CristianBarbaro 4/29/2015 23:43'!initializeroot := DirectoryOO newWithName: 'root'.dir1 := DirectoryOO newWithName: 'dir1'.dir2 := DirectoryOO newWithName: 'dir2'.dir3 := DirectoryOO newWithName: 'dir3'.arch1 := ArchiveOO newWithName: 'arch1' size: 100.arch2 := ArchiveOO newWithName: 'arch2' size: 60.arch3 := ArchiveOO newWithName: 'arch3' size: 200.arch4 := ArchiveOO newWithName: 'arch4' size: 1.root addFile: dir1.dir1 addFile: dir2.dir2 addFile: dir3.root addFile: arch1.dir2 addFile: arch2.dir2 addFile: arch3.dir3 addFile: arch4.fs := FileSystemOO newWithRoot: 'root'.! !Object subclass: #FileOO	instanceVariableNames: 'name creationDate size'	classVariableNames: ''	poolDictionaries: ''	category: 'Objetos 2-TP 2 - Ej 04'!!FileOO methodsFor: 'accessing' stamp: 'CristianBarbaro 4/23/2015 14:34'!creationDate	^ creationDate! !!FileOO methodsFor: 'accessing' stamp: 'CristianBarbaro 4/28/2015 19:18'!size	^ size! !!FileOO methodsFor: 'accessing' stamp: 'CristianBarbaro 4/23/2015 14:42'!creationDate: aDate	creationDate := aDate! !!FileOO methodsFor: 'accessing' stamp: 'CristianBarbaro 4/23/2015 14:41'!name: aString	name := aString! !!FileOO methodsFor: 'accessing' stamp: 'CristianBarbaro 4/23/2015 14:42'!size: aNumber	size := aNumber! !!FileOO methodsFor: 'accessing' stamp: 'CristianBarbaro 4/28/2015 19:17'!name	^ name! !!FileOO methodsFor: 'initialize' stamp: 'CristianBarbaro 4/28/2015 19:05'!initialize	self		name: '';		creationDate: DateAndTime now;		size: 0! !!FileOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/23/2015 14:42'!isArchive	^self subclassResponsibility ! !!FileOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/23/2015 14:42'!isDirectory	^self subclassResponsibility ! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!FileOO class	instanceVariableNames: ''!!FileOO class methodsFor: 'construction' stamp: 'CristianBarbaro 4/28/2015 23:12'!newWithName: aString	^ self new name: aString! !FileOO subclass: #DirectoryOO	instanceVariableNames: 'files contentSize'	classVariableNames: ''	poolDictionaries: ''	category: 'Objetos 2-TP 2 - Ej 04'!!DirectoryOO methodsFor: 'private' stamp: 'CristianBarbaro 4/29/2015 22:45'!privateGetArchivesRecursive: aCollection	"Recorre recursivamente y guarda en la colección recibida por parámetro los archivos, esto se realiza luego de haber estado en los hijos, de esa manera evitzmos que los hijos conozcan el contenido del padre o de los archivos superiores."	self directoriesCollection do: [ :each | each privateGetArchivesRecursive: aCollection ].	^ aCollection addAll: self archivesCollection! !!DirectoryOO methodsFor: 'private' stamp: 'CristianBarbaro 4/29/2015 23:14'!showListPrivate: aString	"Muestra en el Transcript el listado del contenido del directorio, en el formato pedido en el ejercicio."	Transcript		show: aString, ' Directorio ' , self name , '       ' , self totalArchives asString , ' archivos.';		cr.	self directoriesCollection do: [ :each | each showListPrivate: ('---', aString) ]! !!DirectoryOO methodsFor: 'private' stamp: 'CristianBarbaro 4/28/2015 23:34'!archivesCollection	"Retorna una coleccion con los archivos del directorio actual."	^ self files select: [ :each | each isArchive ]! !!DirectoryOO methodsFor: 'private' stamp: 'CristianBarbaro 4/29/2015 22:45'!directoriesCollection	"Retorna una coleccion con los archivos del directorio actual."	^ self files select: [ :each | each isDirectory ]! !!DirectoryOO methodsFor: 'private' stamp: 'CristianBarbaro 4/29/2015 22:36'!totalArchives	^ (self files select: [ :each | each isArchive ]) size! !!DirectoryOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/29/2015 22:34'!biggerArchive	"Retorna el archivo más grande del directorio."	| coll |	coll := OrderedCollection new.	self privateGetArchivesRecursive: coll.	coll isEmpty		ifFalse: [ ^ (coll asSortedCollection: [ :e1 :e2 | e1 size < e2 size ]) last ]		ifTrue: [ ^ nil ]! !!DirectoryOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/23/2015 14:43'!isDirectory	^true! !!DirectoryOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/28/2015 19:16'!addFile: aFile	"Agrega aFile a la colección de files del directorio."	self contentSize: self contentSize + aFile size.	self files add: aFile! !!DirectoryOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/29/2015 22:34'!moreRecentlyArchive	"Retorna el archivo más recientemente creado en cualquier nivel del FS contenido en uno de este directorio."	| coll |	coll := OrderedCollection new.	self privateGetArchivesRecursive: coll.	"Verificar si esta colección queda vacía."	coll isEmpty		ifFalse: [ ^ (coll asSortedCollection: [ :e1 :e2 | e1 creationDate < e2 creationDate ]) last ]		ifTrue: [ ^ nil ]! !!DirectoryOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/23/2015 14:43'!isArchive	^false! !!DirectoryOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/29/2015 23:14'!showList	"Muestra en el Transcript el listado del contenido del directorio, en el formato pedido en el ejercicio."	self showListPrivate: ''! !!DirectoryOO methodsFor: 'accessing' stamp: 'CristianBarbaro 4/23/2015 14:52'!contentSize	^ contentSize! !!DirectoryOO methodsFor: 'accessing' stamp: 'CristianBarbaro 4/23/2015 14:46'!files: aCollection	files := aCollection! !!DirectoryOO methodsFor: 'accessing' stamp: 'CristianBarbaro 4/23/2015 14:52'!contentSize: aNumber	contentSize := aNumber! !!DirectoryOO methodsFor: 'accessing' stamp: 'CristianBarbaro 4/23/2015 14:46'!files	^ files! !!DirectoryOO methodsFor: 'initialize' stamp: 'CristianBarbaro 4/28/2015 23:16'!initialize	super initialize.	self		size: 32;		contentSize: 0;		files: OrderedCollection new! !FileOO subclass: #ArchiveOO	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'Objetos 2-TP 2 - Ej 04'!!ArchiveOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/23/2015 14:43'!isArchive	^true! !!ArchiveOO methodsFor: 'utils' stamp: 'CristianBarbaro 4/23/2015 14:43'!isDirectory	^false! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!ArchiveOO class	instanceVariableNames: ''!!ArchiveOO class methodsFor: 'construction' stamp: 'CristianBarbaro 4/28/2015 19:03'!newWithname: aString	"Inicializa un archivo con tamaño cero."	^self  new name:aString! !!ArchiveOO class methodsFor: 'construction' stamp: 'CristianBarbaro 4/28/2015 23:12'!newWithName: aString size: aNumber	^self new name: aString; size: aNumber! !